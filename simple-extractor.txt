(function(){console.log('%c🔍 Panopto Extraction Started','color:#3b82f6;font-size:20px;font-weight:bold');try{if(!window.PanoptoViewer||!window.PanoptoViewer.deliveryInfo){alert('⚠️ Not on a Panopto video page!\n\nPlease:\n1. Make sure you are on a video player page\n2. The video is loaded\n3. You are signed in');return}const info=window.PanoptoViewer.deliveryInfo;const captions=(info.CaptionSegments||[]).map(seg=>({start:seg.StartTime||0,end:seg.EndTime||0,text:seg.Text||''}));const transcript=captions.map(c=>c.text).join(' ');if(!transcript){alert('❌ No captions found!\n\nThis video may not have captions enabled.');return}console.log('%c✅ Found '+captions.length+' captions!','color:#10b981;font-size:16px');const w=window.open('','','width=800,height=600');w.document.write('<!DOCTYPE html><html><head><title>Panopto Captions</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:system-ui;padding:30px;background:#f8fafc}h1{color:#1e40af;margin-bottom:20px}textarea{width:100%;height:400px;padding:15px;border:2px solid #cbd5e1;border-radius:8px;font-family:monospace;font-size:14px;margin-bottom:15px}button{background:#3b82f6;color:white;border:none;padding:12px 24px;border-radius:8px;font-weight:600;cursor:pointer;margin-right:10px}button:hover{background:#2563eb}.success{background:#10b981;color:white;padding:10px 20px;border-radius:8px;margin-top:10px;display:none}</style></head><body><h1>✅ Extracted '+captions.length+' Captions!</h1><textarea id="t">'+transcript.replace(/</g,'&lt;')+'</textarea><button onclick="navigator.clipboard.writeText(document.getElementById(\'t\').value).then(()=>{document.getElementById(\'s\').style.display=\'block\';setTimeout(()=>document.getElementById(\'s\').style.display=\'none\',2000)})">📋 Copy</button><button onclick="const a=document.createElement(\'a\');a.href=\'data:text/plain,\'+encodeURIComponent(document.getElementById(\'t\').value);a.download=\'captions.txt\';a.click()">💾 Download</button><div id="s" class="success">✅ Copied!</div></body></html>');console.log('%c🎉 Captions displayed in popup!','color:#10b981;font-size:16px;font-weight:bold')}catch(e){console.error('%c❌ Error:','color:#ef4444;font-size:16px',e);alert('❌ Extraction failed: '+e.message)}})();
